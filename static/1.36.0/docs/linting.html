
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Linting</title>
    <meta name="description" content="Janet is a functional and imperative programming language. It runs on Windows, Linux, macOS, FreeBSD and *nix.">
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="../css/docpage.css" type="text/css" media="screen" charset="utf-8">
    <link rel="shortcut icon" href="../assets/favicon.ico">

    <!-- Open Graph -->
    <meta property="og:description" content="Janet is a functional and imperative programming language. It runs on Windows, Linux, macOS, FreeBSD and *nix." />
    <meta property="og:title" content="Linting" />
    <meta property="og:type" content="website" />
  </head>
  <body>

    <div id="toc-toggle" class="open">
      <div class="bar topbar"></div>
      <div class="bar"></div>
      <div class="bar botbar"></div>
    </div>
    <iframe class="search-bar" src="https://duckduckgo.com/search.html?site=janet-lang.org&prefill=Search janet-lang.org" frameborder="0"></iframe>
    <script charset="utf-8">
      function toggleToc() {
        var toggler = document.getElementById('toc-toggle');
        var wrapper = document.querySelector('.toc');
        wrapper.classList.toggle('toc-hidden');
        toggler.classList.toggle('open');
        if (window.localStorage) {
          window.localStorage.setItem('show-toc', toggler.classList.contains('open'));
        }
      }
      function addTocToggle() {
        var el = document.getElementById('toc-toggle');
        if (!window.localStorage || window.localStorage.getItem('show-toc') === 'true') {
          toggleToc()
        }
        el.addEventListener('click', toggleToc);
      }
      window.addEventListener('DOMContentLoaded', addTocToggle);
    </script>

    

    <div class="twocol">
      <div class="toc show-toc">
        <ul>
          <li><span><a href="../index.html">Home</a></span></li><li class="caret"><span><a href="index.html">Documentation</a></span><ul><li><span><a href="syntax.html">Syntax and the Parser</a></span></li><li><span><a href="specials.html">Special Forms</a></span></li><li><span><a href="numbers.html">Numbers and Arithmetic</a></span></li><li><span><a href="comparison.html">Comparison Operators</a></span></li><li><span><a href="bindings.html">Bindings (def and var)</a></span></li><li><span><a href="flow.html">Flow</a></span></li><li><span><a href="functions.html">Functions</a></span></li><li><span><a href="strings.html">Strings, Keywords, and Symbols</a></span></li><li><span><a href="loop.html">Looping</a></span></li><li><span><a href="macros.html">Macros</a></span></li><li class="caret"><span><a href="data_structures/index.html">Data Structures</a></span><ul><li><span><a href="data_structures/arrays.html">Arrays</a></span></li><li><span><a href="data_structures/buffers.html">Buffers</a></span></li><li><span><a href="data_structures/tables.html">Tables</a></span></li><li><span><a href="data_structures/structs.html">Structs</a></span></li><li><span><a href="data_structures/tuples.html">Tuples</a></span></li></ul></li><li><span><a href="destructuring.html">Destructuring</a></span></li><li class="caret"><span><a href="fibers/index.html">Fibers</a></span><ul><li><span><a href="fibers/dynamic_bindings.html">Dynamic Bindings</a></span></li><li><span><a href="fibers/error_handling.html">Errors</a></span></li></ul></li><li><span><a href="modules.html">Modules</a></span></li><li><span><a href="object_oriented.html">Object-Oriented Programming</a></span></li><li><span><a href="peg.html">Parsing Expression Grammars</a></span></li><li><span><a href="prototypes.html">Prototypes</a></span></li><li><span><a href="abstract_machine.html">The Janet Abstract Machine</a></span></li><li><span><a href="event_loop.html">The Event Loop</a></span></li><li><span><a href="threads.html">Multithreading</a></span></li><li><span><a href="networking.html">Networking</a></span></li><li class="caret"><span><a href="process_management/index.html">Process Management</a></span><ul><li><span><a href="process_management/execute.html">Executing</a></span></li><li><span><a href="process_management/spawn.html">Spawning</a></span></li></ul></li><li><span><a href="documentation.html">Documentation</a></span></li><li><span><a href="jpm.html">jpm</a></span></li><li><span class="selected"><a href="linting.html">Linting</a></span></li><li><span><a href="ffi.html">Foreign Function Interface</a></span></li></ul></li><li class="caret"><span><a href="../api/index.html">API</a></span><ul><li><span><a href="../api/array.html">array</a></span></li><li><span><a href="../api/buffer.html">buffer</a></span></li><li><span><a href="../api/bundle.html">bundle</a></span></li><li><span><a href="../api/debug.html">debug</a></span></li><li><span><a href="../api/ev.html">ev</a></span></li><li><span><a href="../api/ffi.html">ffi</a></span></li><li><span><a href="../api/fiber.html">fiber</a></span></li><li><span><a href="../api/file.html">file</a></span></li><li><span><a href="../api/int.html">int</a></span></li><li class="caret"><span><a href="../api/jpm/index.html">jpm</a></span><ul><li><span><a href="../api/jpm/rules.html">rules</a></span></li><li><span><a href="../api/jpm/cc.html">cc</a></span></li><li><span><a href="../api/jpm/cgen.html">cgen</a></span></li><li><span><a href="../api/jpm/cli.html">cli</a></span></li><li><span><a href="../api/jpm/commands.html">commands</a></span></li><li><span><a href="../api/jpm/config.html">config</a></span></li><li><span><a href="../api/jpm/make-config.html">make-config</a></span></li><li><span><a href="../api/jpm/dagbuild.html">dagbuild</a></span></li><li><span><a href="../api/jpm/pm.html">pm</a></span></li><li><span><a href="../api/jpm/scaffold.html">scaffold</a></span></li><li><span><a href="../api/jpm/shutil.html">shutil</a></span></li></ul></li><li><span><a href="../api/math.html">math</a></span></li><li><span><a href="../api/module.html">module</a></span></li><li><span><a href="../api/net.html">net</a></span></li><li><span><a href="../api/os.html">os</a></span></li><li><span><a href="../api/peg.html">peg</a></span></li><li><span><a href="../api/parser.html">parser</a></span></li><li class="caret"><span><a href="../api/spork/index.html">spork</a></span><ul><li><span><a href="../api/spork/argparse.html">argparse</a></span></li><li><span><a href="../api/spork/base64.html">base64</a></span></li><li><span><a href="../api/spork/cc.html">cc</a></span></li><li><span><a href="../api/spork/cjanet.html">cjanet</a></span></li><li><span><a href="../api/spork/crc.html">crc</a></span></li><li><span><a href="../api/spork/channel.html">channel</a></span></li><li><span><a href="../api/spork/cron.html">cron</a></span></li><li><span><a href="../api/spork/data.html">data</a></span></li><li><span><a href="../api/spork/ev-utils.html">ev-utils</a></span></li><li><span><a href="../api/spork/fmt.html">fmt</a></span></li><li><span><a href="../api/spork/generators.html">generators</a></span></li><li><span><a href="../api/spork/getline.html">getline</a></span></li><li><span><a href="../api/spork/htmlgen.html">htmlgen</a></span></li><li><span><a href="../api/spork/http.html">http</a></span></li><li><span><a href="../api/spork/httpf.html">httpf</a></span></li><li><span><a href="../api/spork/infix.html">infix</a></span></li><li><span><a href="../api/spork/json.html">json</a></span></li><li><span><a href="../api/spork/mdz.html">mdz</a></span></li><li><span><a href="../api/spork/math.html">math</a></span></li><li><span><a href="../api/spork/misc.html">misc</a></span></li><li><span><a href="../api/spork/netrepl.html">netrepl</a></span></li><li><span><a href="../api/spork/pgp.html">pgp</a></span></li><li><span><a href="../api/spork/build-rules.html">build-rules</a></span></li><li><span><a href="../api/spork/path.html">path</a></span></li><li><span><a href="../api/spork/randgen.html">randgen</a></span></li><li><span><a href="../api/spork/rawterm.html">rawterm</a></span></li><li><span><a href="../api/spork/regex.html">regex</a></span></li><li><span><a href="../api/spork/rpc.html">rpc</a></span></li><li><span><a href="../api/spork/schema.html">schema</a></span></li><li><span><a href="../api/spork/sh.html">sh</a></span></li><li><span><a href="../api/spork/msg.html">msg</a></span></li><li><span><a href="../api/spork/stream.html">stream</a></span></li><li><span><a href="../api/spork/tasker.html">tasker</a></span></li><li><span><a href="../api/spork/temple.html">temple</a></span></li><li><span><a href="../api/spork/test.html">test</a></span></li><li><span><a href="../api/spork/tarray.html">tarray</a></span></li><li><span><a href="../api/spork/utf8.html">utf8</a></span></li><li><span><a href="../api/spork/zip.html">zip</a></span></li></ul></li><li><span><a href="../api/string.html">string</a></span></li><li><span><a href="../api/table.html">table</a></span></li><li><span><a href="../api/misc.html">misc</a></span></li><li><span><a href="../api/tuple.html">tuple</a></span></li></ul></li><li class="caret"><span><a href="../capi/index.html">C API</a></span><ul><li><span><a href="../capi/wrapping.html">Wrapping Types</a></span></li><li><span><a href="../capi/embedding.html">Embedding</a></span></li><li><span><a href="../capi/configuration.html">Configuration</a></span></li><li><span><a href="../capi/array.html">Array C API</a></span></li><li><span><a href="../capi/buffer.html">Buffer C API</a></span></li><li><span><a href="../capi/table.html">Table C API</a></span></li><li><span><a href="../capi/fiber.html">Fiber C API</a></span></li><li><span><a href="../capi/memory-model.html">Memory Model</a></span></li><li><span><a href="../capi/writing-c-functions.html">Writing C Functions</a></span></li></ul></li>
        </ul>
      </div>
      <div class="content-wrapper main-content">
        <h4 class="subtitle">Janet 1.36.0-c0d7a49 Documentation<br>(Other Versions:
          
          <a href="../../1.35.0/docs/linting.html">1.35.0</a>
          
          <a href="../../1.34.0/docs/linting.html">1.34.0</a>
          
          <a href="../../1.31.0/docs/linting.html">1.31.0</a>
          
          <a href="../../1.29.1/docs/linting.html">1.29.1</a>
          
          <a href="../../1.28.0/docs/linting.html">1.28.0</a>
          
          <a href="../../1.27.0/docs/linting.html">1.27.0</a>
          
          <a href="../../1.26.0/docs/linting.html">1.26.0</a>
          
          <a href="../../1.25.1/docs/linting.html">1.25.1</a>
          
          <a href="../../1.24.0/docs/linting.html">1.24.0</a>
          
          <a href="../../1.23.0/docs/linting.html">1.23.0</a>
          
          <a href="../../1.22.0/docs/linting.html">1.22.0</a>
          
          <a href="../../1.21.0/docs/linting.html">1.21.0</a>
          
          <a href="../../1.20.0/docs/linting.html">1.20.0</a>
          
          <a href="../../1.19.0/docs/linting.html">1.19.0</a>
          
          <a href="../../1.18.1/docs/linting.html">1.18.1</a>
          
          <a href="../../1.17.1/docs/linting.html">1.17.1</a>
          
          <a href="../../1.16.1/docs/linting.html">1.16.1</a>
          
          <a href="../../1.15.0/docs/linting.html">1.15.0</a>
          
          <a href="../../1.13.1/docs/linting.html">1.13.1</a>
          
          <a href="../../1.12.2/docs/linting.html">1.12.2</a>
          
          <a href="../../1.11.1/docs/linting.html">1.11.1</a>
          
          <a href="../../1.10.1/docs/linting.html">1.10.1</a>
          
          <a href="../../1.9.1/docs/linting.html">1.9.1</a>
          
          <a href="../../1.8.1/docs/linting.html">1.8.1</a>
          
          <a href="../../1.7.0/docs/linting.html">1.7.0</a>
          
          <a href="../../1.6.0/docs/linting.html">1.6.0</a>
          
          <a href="../../1.5.1/docs/linting.html">1.5.1</a>
          
          <a href="../../1.5.0/docs/linting.html">1.5.0</a>
          
          <a href="../../1.4.0/docs/linting.html">1.4.0</a>
          
          <a href="../../1.3.1/docs/linting.html">1.3.1</a>
          )</h4>
        <h1 class="subtitle">Linting</h1>
        <div class="prevnext-bar">
          <span class="prev"><a href="jpm.html"><span class="prevnext-text">jpm</span></a></span>

          <span class="next"><a href="ffi.html"><span class="prevnext-text">Foreign Function Interface</span></a></span>
        </div>
        

<p>The <code class="mendoza-code">janet</code> binary comes with a built in linter as of version 1.16.1. This
allows the compiler to emit warnings that don't always need to stop compilation.
Linting is enabled by default at the command line and can be adjusted with the
<code class="mendoza-code">-x</code> and <code class="mendoza-code">-w</code> flags.
</p>
<p>Linting messages from the compiler contain a linting level, a message, and source
code location. There are 3 default levels of linting messages:
</p>
<ul><li><code class="mendoza-code">:relaxed</code> - Reserved for serious messages (priority 1)</li>
    <li><code class="mendoza-code">:normal</code> - The normal default level for linting messages (priority 2)</li>
    <li><code class="mendoza-code">:strict</code> - The linting level reserved for unimportant or nit-picky warnings (priority 3)</li></ul><p>Note that the levels of lints may seem backwards, as the levels of the lint are from the perspective
of the programmer. For example, a "picky" lint message that was warning the user about a matter of style
would only show up if the programmer had `:strict` mode enabled for linting. You can also use the priority
integers directly for lint levels.
</p>
<h2 id="Deprecation">Deprecation
</h2>
<p>There is also support for deprecation messages in the compiler to trigger lint warnings if a user attempts
to use a deprecated binding. Deprecation here is the process of signaling to users that a function or
other binding should not longer be used for new code. Deprecation levels are the same as the linting
levels.
</p>
<pre class="mendoza-codeblock"><code data-language="janet">(<span class="mdzsyn-coresym">defn</span> <span class="mdzsyn-symbol">old-fn</span> 
 <span class="mdzsyn-keyword">:deprecated</span>
 <span class="mdzsyn-string">"This function is deprecated"</span>
 [<span class="mdzsyn-symbol">x</span>]
 (<span class="mdzsyn-coresym">*</span> <span class="mdzsyn-number">2</span> <span class="mdzsyn-symbol">x</span>))

(<span class="mdzsyn-coresym">defn</span> <span class="mdzsyn-symbol">older-fn</span>
 {<span class="mdzsyn-keyword">:deprecated</span> <span class="mdzsyn-keyword">:relaxed</span>}
 <span class="mdzsyn-string">"This function is deprecated, and we really don't want you to use it."</span>
 [<span class="mdzsyn-symbol">x</span>]
 (<span class="mdzsyn-coresym">*</span> <span class="mdzsyn-number">2</span> <span class="mdzsyn-symbol">x</span>))</code></pre><h2 id="Lint-Warnings-and-Errors">Lint Warnings and Errors
</h2>
<p>Whenever Janet code is being executed by the <code class="mendoza-code">run-context</code> function, there are lint thresholds for both
errors and warnings. If a lint message has a level equal to or below the error threshold, it will be converted
into a compiler error. Otherwise, if the lint message has a level equal to or below the warning threshold, a
warning will be printed to <code class="mendoza-code">stderr</code>. Finally, lints above both the error and warning threshold will be
ignored.
</p>
<p>The error threshold can be set with <code class="mendoza-code">(setdyn :lint-error error-threshold)</code>, and the warning threshold can
similarly be set with <code class="mendoza-code">(setdyn :lint-warn warn-threshold)</code>, where threshold values are any of the lint
levels (keywords) or an integer. By default, the error threshold is 0 (no lints will cause an error), and the warn
threshold is 2 (relaxed and normal lints will cause a warning to print, but strict lints will be ignored).
These threshold can also be set at the command line with the <code class="mendoza-code">-w</code> and <code class="mendoza-code">-x</code> flags for the warn and
error thresholds respectively.
</p>
<h2 id="Macro-Linting">Macro Linting
</h2>
<p>Inside macros, Janet exposes an array used to collect lint messages. A function <code class="mendoza-code">maclintf</code> is provided
to help construct error messages if some issue occurs inside a macro. <code class="mendoza-code">maclintf</code> can be used to check
arguments and assert that certain invariants are held when invoking a macro.
</p>
<pre class="mendoza-codeblock"><code data-language="janet">(<span class="mdzsyn-coresym">defmacro</span> <span class="mdzsyn-symbol">my-plus</span>
 <span class="mdzsyn-string">"Do addition and hint that the first argument should be a constant number."</span>
 [<span class="mdzsyn-symbol">x</span> <span class="mdzsyn-symbol">y</span>]
 (<span class="mdzsyn-coresym">unless</span> (<span class="mdzsyn-coresym">number?</span> <span class="mdzsyn-symbol">x</span>)
  (<span class="mdzsyn-coresym">maclintf</span> <span class="mdzsyn-keyword">:normal</span> <span class="mdzsyn-string">"my-plus should be invoked with a numeric constant as x, got %v"</span> <span class="mdzsyn-symbol">x</span>))
 ~(,<span class="mdzsyn-coresym">+</span> ,<span class="mdzsyn-symbol">x</span> ,<span class="mdzsyn-symbol">y</span>))</code></pre><p>Use of <code class="mendoza-code">maclintf</code> over other methods of reporting warnings is
preferred as the programmer has the ability to customize how to handle
different levels of lint messages.  For fatal errors inside the macro,
use the <code class="mendoza-code">error</code> function as usual.
</p>

        <div class="prevnext-bar">
          <span class="prev"><a href="jpm.html"><span class="prevnext-text">jpm</span></a></span>
          <span class="next"><a href="ffi.html"><span class="prevnext-text">Foreign Function Interface</span></a></span>
        </div>
      </div>
    </div>

    
<footer>
  &copy; Calvin Rose &amp; contributors 2024
  <div class="gentag">Generated on September 8, 2024 at 01:51:37 (UTC) with Janet 1.36.0-c0d7a49</div>
  <div class="see-problem">See a problem? Source
    <a href="https://github.com/janet-lang/janet-lang.org">on GitHub</a></div>
</footer>



  </body>
</html>
