
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>data</title>
    <meta name="description" content="Janet is a functional and imperative programming language. It runs on Windows, Linux, macOS, FreeBSD and *nix.">
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="../../css/docpage.css" type="text/css" media="screen" charset="utf-8">
    <link rel="shortcut icon" href="../assets/favicon.ico">

    <!-- Open Graph -->
    <meta property="og:description" content="Janet is a functional and imperative programming language. It runs on Windows, Linux, macOS, FreeBSD and *nix." />
    <meta property="og:title" content="data" />
    <meta property="og:type" content="website" />
  </head>
  <body>

    <div id="toc-toggle" class="open">
      <div class="bar topbar"></div>
      <div class="bar"></div>
      <div class="bar botbar"></div>
    </div>
    <iframe class="search-bar" src="https://duckduckgo.com/search.html?site=janet-lang.org&prefill=Search janet-lang.org" frameborder="0"></iframe>
    <script charset="utf-8">
      function toggleToc() {
        var toggler = document.getElementById('toc-toggle');
        var wrapper = document.querySelector('.toc');
        wrapper.classList.toggle('toc-hidden');
        toggler.classList.toggle('open');
        if (window.localStorage) {
          window.localStorage.setItem('show-toc', toggler.classList.contains('open'));
        }
      }
      function addTocToggle() {
        var el = document.getElementById('toc-toggle');
        if (!window.localStorage || window.localStorage.getItem('show-toc') === 'true') {
          toggleToc()
        }
        el.addEventListener('click', toggleToc);
      }
      window.addEventListener('DOMContentLoaded', addTocToggle);
    </script>

    

    <div class="twocol">
      <div class="toc show-toc">
        <ul>
          <li><span><a href="../../index.html">Home</a></span></li><li class="caret"><span><a href="../../docs/index.html">Documentation</a></span><ul><li><span><a href="../../docs/syntax.html">Syntax and the Parser</a></span></li><li><span><a href="../../docs/specials.html">Special Forms</a></span></li><li><span><a href="../../docs/numbers.html">Numbers and Arithmetic</a></span></li><li><span><a href="../../docs/comparison.html">Comparison Operators</a></span></li><li><span><a href="../../docs/bindings.html">Bindings (def and var)</a></span></li><li><span><a href="../../docs/flow.html">Flow</a></span></li><li><span><a href="../../docs/functions.html">Functions</a></span></li><li><span><a href="../../docs/strings.html">Strings, Keywords, and Symbols</a></span></li><li><span><a href="../../docs/loop.html">Looping</a></span></li><li><span><a href="../../docs/macros.html">Macros</a></span></li><li class="caret"><span><a href="../../docs/data_structures/index.html">Data Structures</a></span><ul><li><span><a href="../../docs/data_structures/arrays.html">Arrays</a></span></li><li><span><a href="../../docs/data_structures/buffers.html">Buffers</a></span></li><li><span><a href="../../docs/data_structures/tables.html">Tables</a></span></li><li><span><a href="../../docs/data_structures/structs.html">Structs</a></span></li><li><span><a href="../../docs/data_structures/tuples.html">Tuples</a></span></li></ul></li><li><span><a href="../../docs/destructuring.html">Destructuring</a></span></li><li class="caret"><span><a href="../../docs/fibers/index.html">Fibers</a></span><ul><li><span><a href="../../docs/fibers/dynamic_bindings.html">Dynamic Bindings</a></span></li><li><span><a href="../../docs/fibers/error_handling.html">Errors</a></span></li></ul></li><li><span><a href="../../docs/modules.html">Modules</a></span></li><li><span><a href="../../docs/object_oriented.html">Object-Oriented Programming</a></span></li><li><span><a href="../../docs/peg.html">Parsing Expression Grammars</a></span></li><li><span><a href="../../docs/prototypes.html">Prototypes</a></span></li><li><span><a href="../../docs/abstract_machine.html">The Janet Abstract Machine</a></span></li><li><span><a href="../../docs/event_loop.html">The Event Loop</a></span></li><li><span><a href="../../docs/threads.html">Multithreading</a></span></li><li><span><a href="../../docs/networking.html">Networking</a></span></li><li class="caret"><span><a href="../../docs/process_management/index.html">Process Management</a></span><ul><li><span><a href="../../docs/process_management/execute.html">Executing</a></span></li><li><span><a href="../../docs/process_management/spawn.html">Spawning</a></span></li></ul></li><li><span><a href="../../docs/documentation.html">Documentation</a></span></li><li><span><a href="../../docs/linting.html">Linting</a></span></li><li><span><a href="../../docs/ffi.html">Foreign Function Interface</a></span></li></ul></li><li class="caret"><span><a href="../../api/index.html">Core API</a></span><ul><li><span><a href="../../api/array.html">array</a></span></li><li><span><a href="../../api/buffer.html">buffer</a></span></li><li><span><a href="../../api/bundle.html">bundle</a></span></li><li><span><a href="../../api/debug.html">debug</a></span></li><li><span><a href="../../api/ev.html">ev</a></span></li><li><span><a href="../../api/ffi.html">ffi</a></span></li><li><span><a href="../../api/fiber.html">fiber</a></span></li><li><span><a href="../../api/file.html">file</a></span></li><li><span><a href="../../api/filewatch.html">filewatch</a></span></li><li><span><a href="../../api/int.html">int</a></span></li><li><span><a href="../../api/janet.html">janet</a></span></li><li><span><a href="../../api/math.html">math</a></span></li><li><span><a href="../../api/module.html">module</a></span></li><li><span><a href="../../api/net.html">net</a></span></li><li><span><a href="../../api/os.html">os</a></span></li><li><span><a href="../../api/peg.html">peg</a></span></li><li><span><a href="../../api/parser.html">parser</a></span></li><li><span><a href="../../api/string.html">string</a></span></li><li><span><a href="../../api/table.html">table</a></span></li><li><span><a href="../../api/misc.html">misc</a></span></li><li><span><a href="../../api/tuple.html">tuple</a></span></li></ul></li><li class="caret"><span><a href="../../capi/index.html">C API</a></span><ul><li><span><a href="../../capi/wrapping.html">Wrapping Types</a></span></li><li><span><a href="../../capi/embedding.html">Embedding</a></span></li><li><span><a href="../../capi/configuration.html">Configuration</a></span></li><li><span><a href="../../capi/array.html">Array C API</a></span></li><li><span><a href="../../capi/buffer.html">Buffer C API</a></span></li><li><span><a href="../../capi/table.html">Table C API</a></span></li><li><span><a href="../../capi/fiber.html">Fiber C API</a></span></li><li><span><a href="../../capi/memory-model.html">Memory Model</a></span></li><li><span><a href="../../capi/writing-c-functions.html">Writing C Functions</a></span></li></ul></li><li class="caret"><span><a href="../../jpm/index.html">JPM</a></span><ul><li><span><a href="../../jpm/building-projects.html">Building Projects</a></span></li><li><span><a href="../../jpm/project.janet.html">Project.janet</a></span></li><li><span><a href="../../jpm/local-install.html">Local Install</a></span></li><li><span><a href="../../jpm/versioning.html">Versioning and Bundling</a></span></li><li class="caret"><span><a href="../../jpm/api/index.html">API</a></span><ul><li><span><a href="../../jpm/api/rules.html">rules</a></span></li><li><span><a href="../../jpm/api/cc.html">cc</a></span></li><li><span><a href="../../jpm/api/cgen.html">cgen</a></span></li><li><span><a href="../../jpm/api/cli.html">cli</a></span></li><li><span><a href="../../jpm/api/commands.html">commands</a></span></li><li><span><a href="../../jpm/api/config.html">config</a></span></li><li><span><a href="../../jpm/api/make-config.html">make-config</a></span></li><li><span><a href="../../jpm/api/dagbuild.html">dagbuild</a></span></li><li><span><a href="../../jpm/api/pm.html">pm</a></span></li><li><span><a href="../../jpm/api/scaffold.html">scaffold</a></span></li><li><span><a href="../../jpm/api/shutil.html">shutil</a></span></li></ul></li></ul></li><li class="caret"><span><a href="../index.html">Spork</a></span><ul><li class="caret"><span><a href="index.html">API</a></span><ul><li><span><a href="argparse.html">argparse</a></span></li><li><span><a href="base64.html">base64</a></span></li><li><span><a href="build-rules.html">build-rules</a></span></li><li><span><a href="cc.html">cc</a></span></li><li><span><a href="channel.html">channel</a></span></li><li><span><a href="cjanet.html">cjanet</a></span></li><li><span><a href="cmath.html">cmath</a></span></li><li><span><a href="crc.html">crc</a></span></li><li><span><a href="cron.html">cron</a></span></li><li><span class="selected"><a href="data.html">data</a></span></li><li><span><a href="ev-utils.html">ev-utils</a></span></li><li><span><a href="fmt.html">fmt</a></span></li><li><span><a href="generators.html">generators</a></span></li><li><span><a href="getline.html">getline</a></span></li><li><span><a href="htmlgen.html">htmlgen</a></span></li><li><span><a href="http.html">http</a></span></li><li><span><a href="httpf.html">httpf</a></span></li><li><span><a href="infix.html">infix</a></span></li><li><span><a href="json.html">json</a></span></li><li><span><a href="math.html">math</a></span></li><li><span><a href="mdz.html">mdz</a></span></li><li><span><a href="misc.html">misc</a></span></li><li><span><a href="msg.html">msg</a></span></li><li><span><a href="netrepl.html">netrepl</a></span></li><li><span><a href="path.html">path</a></span></li><li><span><a href="pgp.html">pgp</a></span></li><li><span><a href="randgen.html">randgen</a></span></li><li><span><a href="rawterm.html">rawterm</a></span></li><li><span><a href="regex.html">regex</a></span></li><li><span><a href="rpc.html">rpc</a></span></li><li><span><a href="schema.html">schema</a></span></li><li><span><a href="services.html">services</a></span></li><li><span><a href="sh.html">sh</a></span></li><li><span><a href="stream.html">stream</a></span></li><li><span><a href="tarray.html">tarray</a></span></li><li><span><a href="tasker.html">tasker</a></span></li><li><span><a href="temple.html">temple</a></span></li><li><span><a href="test.html">test</a></span></li><li><span><a href="utf8.html">utf8</a></span></li><li><span><a href="zip.html">zip</a></span></li></ul></li></ul></li>
        </ul>
      </div>
      <div class="content-wrapper main-content">
        <h4 class="subtitle">Janet 1.39.1-e9c6678 Documentation<br>(Other Versions:
          
          <a href="../../../1.38.0/spork/api/data.html">1.38.0</a>
          
          <a href="../../../1.37.1/spork/api/data.html">1.37.1</a>
          
          <a href="../../../1.36.0/spork/api/data.html">1.36.0</a>
          
          <a href="../../../1.35.0/spork/api/data.html">1.35.0</a>
          
          <a href="../../../1.34.0/spork/api/data.html">1.34.0</a>
          
          <a href="../../../1.31.0/spork/api/data.html">1.31.0</a>
          
          <a href="../../../1.29.1/spork/api/data.html">1.29.1</a>
          
          <a href="../../../1.28.0/spork/api/data.html">1.28.0</a>
          
          <a href="../../../1.27.0/spork/api/data.html">1.27.0</a>
          
          <a href="../../../1.26.0/spork/api/data.html">1.26.0</a>
          
          <a href="../../../1.25.1/spork/api/data.html">1.25.1</a>
          
          <a href="../../../1.24.0/spork/api/data.html">1.24.0</a>
          
          <a href="../../../1.23.0/spork/api/data.html">1.23.0</a>
          
          <a href="../../../1.22.0/spork/api/data.html">1.22.0</a>
          
          <a href="../../../1.21.0/spork/api/data.html">1.21.0</a>
          
          <a href="../../../1.20.0/spork/api/data.html">1.20.0</a>
          
          <a href="../../../1.19.0/spork/api/data.html">1.19.0</a>
          
          <a href="../../../1.18.1/spork/api/data.html">1.18.1</a>
          
          <a href="../../../1.17.1/spork/api/data.html">1.17.1</a>
          
          <a href="../../../1.16.1/spork/api/data.html">1.16.1</a>
          
          <a href="../../../1.15.0/spork/api/data.html">1.15.0</a>
          
          <a href="../../../1.13.1/spork/api/data.html">1.13.1</a>
          
          <a href="../../../1.12.2/spork/api/data.html">1.12.2</a>
          
          <a href="../../../1.11.1/spork/api/data.html">1.11.1</a>
          
          <a href="../../../1.10.1/spork/api/data.html">1.10.1</a>
          
          <a href="../../../1.9.1/spork/api/data.html">1.9.1</a>
          
          <a href="../../../1.8.1/spork/api/data.html">1.8.1</a>
          
          <a href="../../../1.7.0/spork/api/data.html">1.7.0</a>
          
          <a href="../../../1.6.0/spork/api/data.html">1.6.0</a>
          
          <a href="../../../1.5.1/spork/api/data.html">1.5.1</a>
          
          <a href="../../../1.5.0/spork/api/data.html">1.5.0</a>
          
          <a href="../../../1.4.0/spork/api/data.html">1.4.0</a>
          
          <a href="../../../1.3.1/spork/api/data.html">1.3.1</a>
          )</h4>
        <h1 class="subtitle">data</h1>
        <div class="prevnext-bar">
          <span class="prev"><a href="cron.html"><span class="prevnext-text">cron</span></a></span>

          <span class="next"><a href="ev-utils.html"><span class="prevnext-text">ev-utils</span></a></span>
        </div>
        

<p><a href="https://clojure.org/">Clojure</a> contains a very useful core library (or "namespace" in Clojure parlance) called <a href="https://clojure.github.io/clojure/clojure.data-api.html">clojure.data</a> (<a href="https://github.com/clojure/clojure/blob/51c6d7a70912a8f65e81a8e11ae6f56c94920725/src/clj/clojure/data.clj">source</a>). It contains one "exported" function: <code class="mendoza-code">clojure.data/diff</code>. This addition to spork, <code class="mendoza-code">data.janet</code>, should exactly replicate the behavior of <code class="mendoza-code">clojure.data/diff</code> using Janet tables, structs, arrays, and tuples in place of their Clojure equivalents.</p><h2 id="Function">Function
</h2>
<p>The <code class="mendoza-code">diff</code> function recursively compares the structure and contents of two data structures (struct, table, tuple, array) and returns an array with three elements:
</p>
<pre class="mendoza-codeblock"><code data-language="janet">@[<span class="mdzsyn-symbol">things-only-in-a</span> <span class="mdzsyn-symbol">things-only-in-b</span> <span class="mdzsyn-symbol">things-in-both</span>]</code></pre><p>In the case of nested associative data structures (i.e., tables and structs), the comparison is recursive and the data structures are neatly partitioned into the same <code class="mendoza-code">@[things-only-in-a things-only-in-b things-in-both]</code> structure, but arbitrary levels deep in the two original associative data structures.
</p>
<p>This function makes comparing two structs or tables for changes trivial. (An example use case: compare the decoded JSON returned from a REST API call made seconds ago against the version of that same decoded JSON from that same API that was returned from the same call made an hour ago and stored locally in a database for comparison an hour later.)
</p>
<h2 id="Example-0">Example
</h2>
<p>So for example, <code class="mendoza-code">diff</code>'ing the two nested structs <code class="mendoza-code">{:a 1 :b 2 :c {:d 3 :e 4}}</code> and <code class="mendoza-code">{:a 4 :b 2 :c {:d 3 :e 5 :f 6}}</code> looks like this:
</p>
<pre class="mendoza-codeblock"><code data-language="janet"><span class="mdzsyn-symbol">repl:1:&gt;</span> (<span class="mdzsyn-coresym">import</span> <span class="mdzsyn-symbol">spork/data</span> <span class="mdzsyn-keyword">:as</span> <span class="mdzsyn-symbol">d</span>)
<span class="mdzsyn-symbol">repl:2:&gt;</span> (<span class="mdzsyn-symbol">d/diff</span> {<span class="mdzsyn-keyword">:a</span> <span class="mdzsyn-number">1</span> <span class="mdzsyn-keyword">:b</span> <span class="mdzsyn-number">2</span> <span class="mdzsyn-keyword">:c</span> {<span class="mdzsyn-keyword">:d</span> <span class="mdzsyn-number">3</span> <span class="mdzsyn-keyword">:e</span> <span class="mdzsyn-number">4</span>}} {<span class="mdzsyn-keyword">:a</span> <span class="mdzsyn-number">4</span> <span class="mdzsyn-keyword">:b</span> <span class="mdzsyn-number">2</span> <span class="mdzsyn-keyword">:c</span> {<span class="mdzsyn-keyword">:d</span> <span class="mdzsyn-number">3</span> <span class="mdzsyn-keyword">:e</span> <span class="mdzsyn-number">5</span> <span class="mdzsyn-keyword">:f</span> <span class="mdzsyn-number">6</span>}})
@[@{<span class="mdzsyn-keyword">:a</span> <span class="mdzsyn-number">1</span> <span class="mdzsyn-keyword">:c</span> @{<span class="mdzsyn-keyword">:e</span> <span class="mdzsyn-number">4</span>}} @{<span class="mdzsyn-keyword">:a</span> <span class="mdzsyn-number">4</span> <span class="mdzsyn-keyword">:c</span> @{<span class="mdzsyn-keyword">:e</span> <span class="mdzsyn-number">5</span> <span class="mdzsyn-keyword">:f</span> <span class="mdzsyn-number">6</span>}} @{<span class="mdzsyn-keyword">:b</span> <span class="mdzsyn-number">2</span> <span class="mdzsyn-keyword">:c</span> @{<span class="mdzsyn-keyword">:d</span> <span class="mdzsyn-number">3</span>}}]</code></pre><p>The return is <code class="mendoza-code">@[@{:a 1 :c @{:e 4}} @{:a 4 :c @{:e 5 :f 6}} @{:b 2 :c @{:d 3}}]</code> because:
</p>
<ul>
  <li>the value for <code class="mendoza-code">:a</code> appears in both and is different in each one (so <code class="mendoza-code">:a</code> is a key in both the first and second returned table, with each value set as seen in the first and second original structs)</li>
  <li>the value for <code class="mendoza-code">:b</code> appears in both and is the same in each (so <code class="mendoza-code">:b</code> is a key only in the third returned table, containing the shared value in both original strucs)</li>
  <li>the nested value of <code class="mendoza-code">:d</code> appears in both and is the same in each (so <code class="mendoza-code">:c</code> is a key in the third returned table, containing the value of <code class="mendoza-code">:d</code> that is shared in both original structs)</li>
  <li>the nested value of <code class="mendoza-code">:e</code> appears in both and is different in each one (so <code class="mendoza-code">:c</code> is a key in both the first and second returned table, containing the value <code class="mendoza-code">:e</code> with with each value set as seen in the first and second original structs), and</li>
  <li>the key/value pair <code class="mendoza-code">:f</code> 6 only appears in the latter original struct (so only the second returned table contains <code class="mendoza-code">:f</code> and its value).</li>
</ul><h2 id="Reference-8">Reference
</h2>
<p><a href="#data/diff">data/diff</a> </p><hr><div class="binding"><span id="data/diff" class="binding-sym">data/diff</span> <span class="binding-type">var (function)</span>  <pre class="binding-text">(diff a b)

 
Compares a and b recursively. Returns an array of 
@[things-only-in-a things-only-in-b things-in-both]. </pre></div>
        <div class="prevnext-bar">
          <span class="prev"><a href="cron.html"><span class="prevnext-text">cron</span></a></span>
          <span class="next"><a href="ev-utils.html"><span class="prevnext-text">ev-utils</span></a></span>
        </div>
      </div>
    </div>

    
<footer>
  &copy; Calvin Rose &amp; contributors 2025
  <div class="gentag">Generated on August 30, 2025 at 17:18:20 (UTC) with Janet 1.39.1-e9c6678</div>
  <div class="see-problem">See a problem? Source
    <a href="https://github.com/janet-lang/janet-lang.org">on GitHub</a></div>
</footer>



  </body>
</html>
